<!DOCTYPE html>
<html>
<head>
	<title>Finance Monster (TBD)</title>
	<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body style="margin:0; padding:0;">
	<div id="initialView">
		<div style="display:flex; flex-direction: column; align-items: center; width:320px; height:480px; margin: 0 auto; background-color:lightgray;">
			<div style="flex-grow: 1;">
				<h1>Finance Monster</h1>
			</div>
			<div style="flex-grow: 1;">
				<button onclick="setGoal()">Enter Your Daily Goal</button>
			</div>
		</div>
	</div>
	<div id="gameView">
		<div style="display:flex; flex-direction: column; align-items: center; width:320px; height:480px; margin: 0 auto; background-color:lightgray;">
			<div style="position:relative; width:100%;">
				<img src="Sprites/static/UncollectedMeat1.png" id="collectIcon" onclick="collectReward()" style="position:absolute; top:0; right:0; width:25px; height:25px;">
			</div>
			<div style="flex-grow: 1;">
				<h1>Finance Monster</h1>
			</div>
			<div style="flex-grow: 1; text-align:center;">
				<div>
					<img src="Sprites/animated/Slime1GIF.gif" style="width: 50px; height: 50px;">
				</div>
				<div>
					<span id="monsterName">Slimey</span><img id="monsterEdit" onclick="editMonsterName()" style="width: 10px; height: 10px; background-color:gray; position:absolute;">
				</div>
				<div style="width:200px; background-color:lightblue;">
					<span>EXP: </span><span id="expCurrent">0</span>/<span id="expTotal">0</span>
				</div>
			</div>
			<div style="flex-grow: 1;">
				<span id="goalLabel">Goal: </span><span id="goalAmount">0</span>
			</div>
			<div style="flex-grow: 1;">
				<span id="spendLabel">Spend: </span><span id="spendAmount">0</span>
			</div>
			<div style="flex-grow: 1;">
				<button onclick="enterAmount()">Enter</button>
			</div>
			<div style="flex-grow: 1;">
				<button onclick="setGoal()">Enter New Daily Goal</button>
			</div>
		</div>
	</div>
<script>
	var goalAmount = 0;
	var spendAmount = 0;
	var rewardAmount = 0;
	var starvationAmount = 0;
	var foodAmount = 0;
	var expTotal = 0;
	var expModifier = 5;
	var monsterName = "Slimey";
	var didNotLog = true;
	var alreadyCollected = false;

	function setGoal() {
		goalAmount = parseInt(prompt("Goal: ", "0")) || 0;
		document.getElementById("goalAmount").innerHTML = goalAmount;
		expTotal = goalAmount * expModifier;
		document.getElementById("expTotal").innerHTML = expTotal;
		
		switchView("game");
	};
	
	function initialize() {
		document.getElementById("gameView").style.display = "none";
	};
	initialize();
	
	function enterAmount() {
		spendAmount = parseInt(prompt("Spend: ", "0")) || 0;
		document.getElementById("spendAmount").innerHTML = spendAmount;
		didNotLog = false;
	};
	
	function setSpendAmount(value) {
		spendAmount = value;
		document.getElementById("spendAmount").innerHTML = spendAmount;
	};
	
	function switchView(type) {
		switch(type) {
			case "initial":
				document.getElementById("initialView").style.display = "inline";
				document.getElementById("gameView").style.display = "none";
				break;
			case "game":
				document.getElementById("initialView").style.display = "none";
				document.getElementById("gameView").style.display = "inline";
				break;
			default:
				document.getElementById("initialView").style.display = "none";
				document.getElementById("gameView").style.display = "inline";
		}
	};
	
	function collectReward() {
		if (!(alreadyCollected)) {
			alert("You've earned " + rewardAmount + " food!");
			foodAmount = foodAmount + rewardAmount;
			document.getElementById("expCurrent").innerHTML = foodAmount;
			collectDone();
		} else {
			alert("You've already collected food for today!");
		}
		
	};
	
	function endOfDayCalculations() {
		if (didNotLog) {
			starvationAmount += 1;
			collectDisabled();
		} else {
			rewardAmount = goalAmount - spendAmount;
			if (rewardAmount < 0) {
				starvationAmount += 1;
			} else {
				starvationAmount = 0;
			}
			collectEnabled();
		}
		displayInfo();
		setSpendAmount(0);
		didNotLog = true;
	};
	
	function displayInfo() {
		console.log("Reward: " + rewardAmount + "\nStarvation: " + starvationAmount + "\nFood: " + foodAmount);
	};
	
	function collectDisabled() {
		document.getElementById("collectIcon").style.display = "none";
	};
	collectDisabled();
	
	function collectEnabled() {
		alreadyCollected = false;
		document.getElementById("collectIcon").src = "Sprites/static/UncollectedMeat1.png";
		document.getElementById("collectIcon").style.display = "inline";
	};
	
	function collectDone() {
		alreadyCollected = true;
		document.getElementById("collectIcon").src = "Sprites/static/CollectedMeat1.png";
	};
	
	function editMonsterName() {
		monsterName = prompt("What shall I be named?", monsterName) || monsterName;
		document.getElementById("monsterName").innerHTML = monsterName;
	};
	
	var timer = setInterval(endOfDayCalculations, 10000);
</script>
</body>
</html>